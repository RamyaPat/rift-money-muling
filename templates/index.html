<!DOCTYPE html>
<html>
<head>
    <title>Fraud Intelligence SaaS</title>

    <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
/* -------------------- General -------------------- */
* { box-sizing: border-box; }
body { margin:0; font-family: 'Times New Roman', Times, serif; background: linear-gradient(135deg, #0f172a, #111827); color:#e2e8f0; overflow-x:hidden; transition:0.4s; }
body.light { background:#f5f7fa; color:#0f172a; }
#page-root { position:relative; }
#particles { position:fixed; width:100%; height:100%; z-index:-1; top:0; left:0; }

header { padding:20px 40px; display:flex; justify-content:space-between; align-items:center; background: rgba(30,41,59,0.8); backdrop-filter: blur(10px); border-bottom:1px solid rgba(255,255,255,0.05); position: sticky; top:0; z-index:100; }
header h1 { margin:0; font-size:22px; background: linear-gradient(90deg, #38bdf8, #22d3ee); background-clip:text; -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
nav a { margin-left:20px; color:#38bdf8; text-decoration:none; cursor:pointer; font-weight:bold; transition:0.3s; }
nav a.active, nav a:hover { text-decoration:underline; color:#a855f7; }

button { padding:10px 16px; background: linear-gradient(90deg, #b0e0ff, #89cff0, #b0e0ff); background-size:200% auto; animation: neonMove 3s linear infinite; border:none; border-radius:8px; color:#001f3f; font-weight:bold; cursor:pointer; transition:0.3s; }
button:hover { transform: translateY(-2px); box-shadow:0 0 15px rgba(176,224,255,0.8); }
@keyframes neonMove { 0% { background-position:0% center; } 100% { background-position:200% center; } }

.container { padding:40px; }
/* Page transition helpers */
.page { transition: opacity 360ms ease, transform 360ms ease; opacity:1; transform:translateY(0); }
.page.hidden { opacity:0; transform:translateY(8px); pointer-events:none; }

/* Card count-up visual */
.card.counting { transform:translateY(-6px) scale(1.02); box-shadow:0 10px 30px rgba(56,189,248,0.18); transition:transform 360ms ease, box-shadow 360ms ease; }

/* Table / row transitions */
table { transition: opacity .28s ease, transform .28s ease; }
tr.row-enter { opacity:0; transform:translateY(8px); }
tr { transition: opacity .36s ease, transform .36s ease; }

/* Tooltip */
.tooltip { position:fixed; pointer-events:none; background:rgba(15,23,42,0.95); color:#e2e8f0; padding:8px 10px; border-radius:8px; font-size:13px; box-shadow:0 6px 20px rgba(2,6,23,0.6); z-index:9999; white-space:nowrap; transform:translate(-50%, -120%); }
.tooltip.hidden { display:none; }
@keyframes fadeIn { from {opacity:0; transform:translateY(15px);} to {opacity:1; transform:translateY(0);} }

.cards { display:grid; grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); gap:20px; margin-top:30px; }
.card { background: rgba(30,41,59,0.5); backdrop-filter:blur(20px); border-radius:16px; padding:20px; border:1px solid rgba(255,255,255,0.05); transition:0.3s; box-shadow:0 0 10px rgba(56,189,248,0.2); }
.card:hover { transform: translateY(-5px); box-shadow:0 0 20px rgba(56,189,248,0.5); }
.card h3 { font-size:16px; color:#94a3b8; margin:0; }
.card p { font-size:20px; margin:10px 0 0; font-weight:bold; }

.section { margin-top:50px; }
table { width:100%; border-collapse:collapse; margin-top:15px; background: rgba(30,41,59,0.3); border-radius:12px; overflow:hidden; box-shadow:0 0 15px rgba(56,189,248,0.3); transition:0.2s; }
th, td { padding:12px; text-align:center; }
th { background: rgba(255,255,255,0.05); }
tr:hover { transform:scale(1.01); background: rgba(56,189,248,0.1); box-shadow:0 0 10px rgba(56,189,248,0.2); }
.badge { padding:5px 12px; border-radius:20px; font-size:12px; font-weight:bold; }
.high { background:#ef4444; color:white; }
.medium { background:#f59e0b; color:white; }
.low { background:#22c55e; color:white; }

.success-banner { margin-top:20px; padding:12px; background:#22c55e20; border:1px solid #22c55e; border-radius:8px; color:#22c55e; }
.alert-banner { margin-top:20px; padding:12px; background:#ef444420; border:1px solid #ef4444; border-radius:8px; color:#ef4444; }

#cy { height:400px; margin-top:20px; border-radius:16px; background:#0f172a; border:1px solid rgba(255,255,255,0.05); }
.spinner { margin-top:20px; border:4px solid #1e293b; border-top:4px solid #38bdf8; border-radius:50%; width:40px; height:40px; animation:spin 1s linear infinite; }
@keyframes spin { 100%{transform:rotate(360deg);} }
.hidden{display:none;}

/* Pulsing suspicious node effect */
.suspicious { animation: pulse 1.5s infinite; }
@keyframes pulse { 0% { box-shadow:0 0 5px #a855f7;} 50% { box-shadow:0 0 20px #a855f7;} 100% { box-shadow:0 0 5px #a855f7;} }
</style>
</head>

<body>
<div id="particles"></div>

<header>
<h1>üîê Fraud Intelligence SaaS</h1>
<nav>
<a onclick="showPage('home')" class="active">Home</a>
<a onclick="showPage('dashboard')">Dashboard</a>
<a onclick="showPage('reports')">Reports</a>
<a onclick="toggleTheme()">üåó Theme</a>
</nav>
</header>

<div class="container">

<!-- Home Page -->
<div id="home" class="page">
<h2>Welcome to Fraud Intelligence Platform</h2>
<p>Real-time fraud detection, interactive dashboards, and executive reports at your fingertips.</p>
<div class="cards">
<div class="card"><h3>Real-time Detection</h3><p>Analyze accounts instantly</p></div>
<div class="card"><h3>Fraud Network</h3><p>Visualize suspicious patterns</p></div>
<div class="card"><h3>Executive Reports</h3><p>Export insights to PDF</p></div>
<div class="card"><h3>Security Alerts</h3><p>Receive instant notifications</p></div>
</div>
</div>

<!-- Dashboard Page -->
<div id="dashboard" class="page hidden">
<form id="uploadForm">
<input type="file" name="file" required />
<button type="submit">Run Fraud Analysis</button>
</form>
<button onclick="exportPDF()" style="margin-top:15px;">üìÑ Download Executive PDF</button>
<div id="loader" class="spinner hidden"></div>
<div id="banner"></div>

<div class="cards">
<div class="card"><h3>Total Accounts</h3><p id="total">0</p></div>
<div class="card"><h3>Suspicious Accounts</h3><p id="suspicious">0</p></div>
<div class="card"><h3>Fraud Rings</h3><p id="rings">0</p></div>
<div class="card"><h3>Processing Time (s)</h3><p id="time">0</p></div>
</div>

<div class="section">
<h2>Live Fraud Risk Gauge</h2>
<div style="max-width:250px; margin:auto;"><canvas id="riskGauge"></canvas></div>
</div>

<div class="section">
<h2>Top 5 High-Risk Accounts</h2>
<div id="topAccounts"></div>
</div>

<div class="section">
<h2>Fraud Ring Summary</h2>
<div id="ringSummary"></div>
</div>

<div class="section">
<h2>Interactive Fraud Network</h2>
<div id="cy"></div>
</div>
</div>

<!-- Reports Page -->
<div id="reports" class="page hidden">
<h2>Historical Fraud Reports</h2>
<p>Trend charts, summary cards, and full records table.</p>

<!-- Summary cards -->
<div class="cards">
<div class="card"><h3>Last Week Alerts</h3><p id="weeklyAlerts">0</p></div>
<div class="card"><h3>Top Risk Accounts</h3><p id="topRisk">0</p></div>
<div class="card"><h3>Total Rings</h3><p id="totalRings">0</p></div>
</div>

<!-- Trend Charts -->
<div class="section">
<h2>Fraud Trends (Last 7 Days)</h2>
<canvas id="trendChart" style="max-width:600px; margin:auto;"></canvas>
</div>

<!-- Historical Records Table -->
<div class="section">
<h2>Historical Records</h2>
<table id="historyTable">
<tr>
<th>Date</th><th>Account</th><th>Suspicion Score</th><th>Risk Level</th>
</tr>
<!-- Records dynamically populated -->
</table>
</div>
</div>
</div>

<script>
/* ---------------- Page Switching ---------------- */
function showPage(page){
  document.querySelectorAll('.page').forEach(p=>p.classList.add('hidden'));
  document.getElementById(page).classList.remove('hidden');
  document.querySelectorAll('nav a').forEach(a=>a.classList.remove('active'));
  document.querySelector(`nav a[onclick="showPage('${page}')"]`).classList.add('active');
}

/* ---------------- Theme Toggle ---------------- */
function toggleTheme(){
  document.body.classList.toggle('light');
  localStorage.setItem('theme', document.body.classList.contains('light')?'light':'dark');
}
if(localStorage.getItem('theme')==='light'){ document.body.classList.add('light'); }

/* ---------------- Particles ---------------- */
particlesJS("particles", { particles:{ number:{ value:60 }, size:{ value:3 }, move:{ speed:1 }, line_linked:{ enable:true }, color:{ value:"#38bdf8" } } });

let gaugeChart, cyInstance;

/* ---------------- Upload & Dashboard ---------------- */
document.getElementById("uploadForm").onsubmit = async function(e){
    e.preventDefault();
    document.getElementById("loader").classList.remove("hidden");
    document.getElementById("dashboard").classList.add("hidden");

    // Simulated data response (replace with fetch for backend)
    setTimeout(()=>{
        const data={
            summary:{total_accounts_analyzed:500,suspicious_accounts_flagged:12,fraud_rings_detected:3,processing_time_seconds:5},
            suspicious_accounts:[
                {account_id:'A001',suspicion_score:80},{account_id:'A002',suspicion_score:65}
            ],
            fraud_rings:[{ring_id:'R1',member_accounts:['A001','A002'],pattern_type:'Loop'}],
            graph:{nodes:[{id:'A001',suspicious:true},{id:'A002',suspicious:false}],edges:[{source:'A001',target:'A002'}]}
        };
        document.getElementById("loader").classList.add("hidden");
        document.getElementById("dashboard").classList.remove("hidden");

        animate('total', data.summary.total_accounts_analyzed);
        animate('suspicious', data.summary.suspicious_accounts_flagged);
        animate('rings', data.summary.fraud_rings_detected);
        animate('time', data.summary.processing_time_seconds);
        showBanner(data.summary.suspicious_accounts_flagged);
        renderTop(data.suspicious_accounts.slice(0,5));
        renderRings(data.fraud_rings);
        renderGraph(data.graph);

        // Update reports page dynamically
        populateReports(data.suspicious_accounts);
    },1000);
}

/* ---------------- Animations & Tables ---------------- */
function animate(id,value){ let start=0,duration=800,startTime=null; function step(ts){ if(!startTime) startTime=ts; let progress=ts-startTime; let val=Math.min(start+(value*(progress/duration)),value); document.getElementById(id).innerText=val.toFixed(2); if(progress<duration) requestAnimationFrame(step); } requestAnimationFrame(step); }

function showBanner(suspicious){
  const banner=document.getElementById("banner");
  banner.innerHTML = suspicious>0?`<div class="alert-banner">‚ö† ${suspicious} suspicious accounts detected!</div>`:`<div class="success-banner">‚úÖ No suspicious activity detected.</div>`;
}

function renderTop(accounts){
  let highest = accounts.length>0 ? accounts[0].suspicion_score : 0;
  updateGauge(highest);
  let html="<table><tr><th>Account</th><th>Score</th><th>Risk</th></tr>";
  accounts.forEach(a=>{
    let cls=a.suspicion_score>=70?'high':(a.suspicion_score>=40?'medium':'low');
    html+=`<tr><td>${a.account_id}</td><td>${a.suspicion_score}</td><td><span class="badge ${cls}">${cls.toUpperCase()}</span></td></tr>`;
  });
  html+="</table>";
  document.getElementById("topAccounts").innerHTML=html;
}

function updateGauge(score){
  const ctx=document.getElementById("riskGauge");
  if(gaugeChart) gaugeChart.destroy();
  gaugeChart=new Chart(ctx,{
    type:'doughnut',
    data:{ datasets:[{ data:[score,100-score], backgroundColor:['#ef4444','#1e293b'], borderWidth:0 }]},
    options:{responsive:true, maintainAspectRatio:true, aspectRatio:1.5, cutout:'60%', plugins:{legend:{display:false}}}
  });
}

function renderRings(rings){
  let html="<table><tr><th>Ring ID</th><th>Members</th><th>Pattern</th></tr>";
  rings.forEach(r=>{
    html+=`<tr><td>${r.ring_id}</td><td>${r.member_accounts.length}</td><td>${r.pattern_type}</td></tr>`;
  });
  html+="</table>";
  document.getElementById("ringSummary").innerHTML=html;
}

function renderGraph(graph){
  if(cyInstance) cyInstance.destroy();
  const elements=[];
  graph.nodes.forEach(n=>elements.push({data:{id:n.id},classes:n.suspicious?'suspicious':''}));
  graph.edges.forEach(e=>elements.push({data:{source:e.source,target:e.target}}));
  cyInstance=cytoscape({
    container:document.getElementById("cy"),
    elements:elements,
    style:[
      {selector:'node', style:{'label':'data(id)','background-color':'#8b5cf6','color':'#fff','font-size':8}},
      {selector:'.suspicious', style:{'background-color':'#a855f7','width':40,'height':40,'shadow-blur':25,'shadow-color':'#a855f7'}},
      {selector:'edge', style:{'line-color':'#64748b','target-arrow-shape':'triangle','target-arrow-color':'#64748b'}}
    ],
    layout:{name:'cose'}
  });
}

/* ---------------- PDF Export ---------------- */
function exportPDF(){
  const { jsPDF }=window.jspdf;
  const doc=new jsPDF();
  doc.setFont('times');
  doc.setFontSize(16);
  doc.text('Fraud Intelligence Executive Report',20,20);
  doc.setFontSize(12);
  doc.text('Generated: '+new Date().toLocaleString(),20,30);
  doc.text('Total Accounts: '+document.getElementById('total').innerText,20,45);
  doc.text('Suspicious Accounts: '+document.getElementById('suspicious').innerText,20,55);
  doc.text('Fraud Rings: '+document.getElementById('rings').innerText,20,65);
  doc.save('Executive_Fraud_Report.pdf');
}

/* ---------------- Reports Chart ---------------- */
const ctxTrend=document.getElementById('trendChart');
new Chart(ctxTrend,{ type:'line', data:{ labels:['Mon','Tue','Wed','Thu','Fri','Sat','Sun'], datasets:[{label:'Suspicious Accounts', data:[5,7,3,6,4,8,6], borderColor:'#38bdf8', backgroundColor:'rgba(56,189,248,0.2)'}]}, options:{ responsive:true, plugins:{legend:{display:true}}}});

/* ---------------- Populate Reports Table ---------------- */
function populateReports(accounts){
  const table=document.getElementById('historyTable');
  table.innerHTML='<tr><th>Date</th><th>Account</th><th>Suspicion Score</th><th>Risk Level</th></tr>';
  accounts.forEach(a=>{
    const risk=a.suspicion_score>=70?'HIGH':(a.suspicion_score>=40?'MEDIUM':'LOW');
    table.innerHTML+=`<tr><td>${new Date().toLocaleDateString()}</td><td>${a.account_id}</td><td>${a.suspicion_score}</td><td><span class="badge ${risk.toLowerCase()}">${risk}</span></td></tr>`;
  });

  // Update cards
  document.getElementById('weeklyAlerts').innerText=accounts.length;
  document.getElementById('topRisk').innerText=accounts.reduce((max,a)=>Math.max(max,a.suspicion_score),0);
  document.getElementById('totalRings').innerText=1; // example
}
</script>
</body>
</html>
